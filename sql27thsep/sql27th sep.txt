
1. Extract the middle 3 characters from the string 'ABCDEFG'.
select SUBSTRING('abcdefg',3,3) as 'middleofstring ';

2. From a table 'Employees' with a column 'FullName', write a query to extract the first name (assuming it's always the first word before a space).
select	substring(full_name,1,charindex(' ',full_name+' ')-1) from Employees;

3.Extract the first 5 characters from the string 'SQL Server 2022'.
select SUBSTRING('SQL SERVER 2022' ,1,5);

4. From a 'Products' table with a 'ProductCode' column, write a query to get the first 3 characters of each product code.
select substring(productCode,1,3) from Products;

5. Extract the last 4 characters from the string 'ABCDEFGHIJKL'.
select right('abcdefghijkl',5);

6.From an 'Orders' table with an 'OrderID' column (format: ORD-YYYY-NNNN), write a query to extract just the numeric portion at the end.
  select right([product code],4) from products;

7. Write a query to find the length of the string 'SQL Server Functions'.
select len('SQL SERVER Functions');

8. From a 'Customers' table, find customers whose names are longer than 20 characters.
select customername from Customer where len(customername)>20; 

9. Compare the results of character count and byte count for the string 'SQL Server' with a trailing space.
select datalength('sql server ');     _____________:output =11(bytecount)
select len('sql server '); ________________________:output=10(char count)


10. Write a query to find the byte count of an empty string and explain the result.
select datalength('');_________________________output=0 bcoz here nothing is to be stored 

11. Find the position of 'Server' in the string 'Microsoft SQL Server'.
select CHARINDEX('server','microsoft sql server');

12. From an 'Emails' table, write a query to extract the domain name from email addresses.
select substring(emailid,charindex('@',emailid),len(emailid)) from employees;

13. Find the position of the first number in the string 'ABC123DEF456'.
select PATINDEX('%[0-9]%','ABC123DEF456');

14. Write a query to find all product names from a 'Products' table that contain a number.
select productname from products where patindex('%[0-9]%',productname)>0;

15. Join the strings 'SQL', 'Server', and '2022' with spaces between them.
select CONCAT_WS('-','sql','server','2022');

16. From 'Employees' table with 'FirstName' and 'LastName' columns, create a 'FullName' column.
select CONCAT_WS(' ',firstname,lastname) as fullname from employees;

17. Join the array ('SQL', 'Server', '2022') with a hyphen as the separator.
select CONCAT_WS('-','sql','server','2022');

18. From an 'Addresses' table, combine 'Street', 'City', 'State', and 'ZIP' columns into a single address string.
select concat_ws(',',street,city,state,zip) from address;

19. Change all occurrences of 'a' to 'e' in the string 'database management'.
select replace('database management','a','e');

20. From a 'Products' table, write a query to replace all spaces in product names with underscores.
select replace(productname,' ','-') from products;

21. Create a string of 10 asterisks (*).
select replicate('*',10);

22. Write a query to pad all product codes in a 'Products' table to a length of 10 characters with leading zeros.
select right(replicate('0',10)+[product code],10) from products;

23. Insert the string 'New ' at the beginning of 'York City'.
select concat_ws(' ','new'+ 'York city');    

24. From an 'Emails' table, mask the username part of email addresses, showing only the first and last characters.
select concat_ws('',left(emailID,1),replicate('*',charindex('@',emailID)),right(emailID,len(emailID)-charindex('@',emailID)+2)) from employees;

25. Convert the string 'sql server' to uppercase.
select upper('sql server');

26. Write a query to convert all customer names in a 'Customers' table to uppercase.
select upper(customername) from customers;

27. Convert the string 'SQL SERVER' to lowercase.
select lower('SQL SERVER');

28. From a 'Products' table, write a query to convert all product descriptions to lowercase.
select lower(productdescription) from products;

29. Remove trailing spaces from the string 'SQL Server    '.
select rtrim('SQL Server    ', ' ');

30. Write a query to remove trailing spaces from all email addresses in an 'Employees' table.
select rtrim(emailID,' ') from employees;

31. Remove leading spaces from the string '   SQL Server'.
select ltrim('   SQL Server',' ');

32. From a 'Comments' table, write a query to remove leading spaces from all comment texts.
select ltrim(comments,' ') from comments;

33. Display the current date in the format 'dd-MM-yyyy'.
select format(getdate(),'dd-MM-yyyy');


34. From an 'Orders' table with an 'OrderTotal' column, display the total as a currency with 2 decimal places.
select round(OrderTotal,2) from orders;

35. Separate the string 'apple,banana,cherry' into individual fruits.
declare @fruits nvarchar(30)='apple,banana,cherry';
select value as fruitName from string_split(@fruits,',');

36. From a 'Skills' table with a 'SkillList' column containing comma-separated skills, write a query to create a row for each individual skill.
select value as individualSkill from skills cross apply string_split(skillList,',');


Date and Time Functions

37. Write a query to display the current date and time.
select GETDATE();

38. From an 'Orders' table, find all orders placed in the last 24 hours.
select * from orders where DATEDIFF(hour,orderdate,getdate())<=24;

39. Display the current UTC date and time.
select SYSUTCDATETIME();

40. Write a query to show the time difference between local time and UTC time.
select datediff(hour,sysdatetime(),sysutcdatetime());


41. Convert the current date and time to 'Pacific Standard Time'.
select sysdatetime() at time zone 'pacific standard time' as pacific_time;

42. From a 'Flights' table with a 'DepartureTime' column in UTC, convert all departure times to 'Eastern Standard Time'.
update flights set departuretime=departuretime at time zone 'Eastern Standard Time';

43. Add 3 months to the current date.
select dateadd(month,3,getdate());

44. From an 'Employees' table, write a query to calculate each employee's retirement date (65 years from their 'DateOfBirth').
select datediff(year,getdate(),DateOfBirth)) from employees where datediff(year,getdate(),DateOfBirth))>=65;


45. Calculate the number of days between '2023-01-01' and '2023-12-31'.
select datediff(day,'2023-01-01','2023-12-31');

46. From an 'Orders' table, find the average number of days between order date and ship date.
select avg(datediff(day,orderDate,shipDate)) as averageOfDays from Orders;

47. Extract the month number from the date '2023-09-15'.
select month('2023-09-15') as month_of_day;

48. From a 'Sales' table, write a query to group total sales by the quarter of the sale date.
select count(quantity),datename(quarter,saledate) from Sales group by datename(quarter,saledate);

49. Extract the year from the current date.
select year(getdate());

50. From an 'Employees' table, find all employees hired in the year 2022.
select * from employees where year(hiredate)=2022;

51. Check if '2023-02-30' is a valid date.
if try_convert(date,'2023-02-30') is not null begin print 'date is valid' end else begin print'date is invalid' end;

52. Write a query to find all rows in a 'UserInputs' table where the 'EnteredDate' column contains invalid dates.
select * from UserInputs where try_convert(date,EnteredDate) is null;

53. Find the last day of the current month.
select eomonth(getdate());

54. From a 'Subscriptions' table, write a query to extend all subscription end dates to the end of their respective months.
update subscriptions set subscriptionenddate=eomonth(subscriptionenddate);

55. Display the current date and time.
select getdate();

56. Compare the results of two different methods to get the current timestamp - are they always the same?
select getdate() as date ,sysdatetime() as systemdate;
Here,sysdatetime() gives value with higher precision.


57. Get the current date and time with higher precision than standard methods.
select sysdatetime() as precisiondatetime;

58. Write a query to insert the current high-precision timestamp into a 'Logs' table.
insert into logs(precision_timestamp) values(sysdatetime());

59. Display the current UTC date and time with high precision.
select SYSDATETIMEOFFSET() as currentdate;


60. Calculate the difference in microseconds between the current local time and UTC time.
select datepart(microsecond,datediff(day,getdate(),sysutcdatetime()));

61. Get the current date, time, and time zone offset.
select sysdatetimeoffset();

62. From a 'GlobalEvents' table, convert all event times to include time zone offset information.
alter table globalevents  alter column eventtimes datetimeoffset;

63. Extract the month number from the date '2023-12-25'.
select month('2023-12-25') as monthofdate;

64. From a 'Sales' table, find the total sales for each month of the previous year.
 select month(Orderdate),sum(totalsales) from Sales where year(OrderDate)=year(getdate())-1  group by month(OrderDate);

65. Extract the day of the month from '2023-03-15'.
select month('2023-03-15');

66. Write a query to find all orders from an 'Orders' table that were placed on the 15th day of any month.
select * from Orders where day(orderDate)=15;

67. Get the name of the month for the date '2023-09-01'.
select datename(month,'2023-09-01');

68. From an 'Events' table, write a query to display the day of the week (in words) for each event date.
select datename(weekday,eventdate) from Events;

69. Create a date for Christmas Day 2023.
select cast('2023-12-25' as date) as christmasday2023;

70. Write a query to convert separate year, month, and day columns from a 'Dates' table into a single DATE column.
select concat_ws('-',year,month,day) as datename from Dates;


